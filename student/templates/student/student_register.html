<!DOCTYPE html>
{% extends 'student/base.html' %}
{% load static %}

<!-- title -->
{% block title %}生徒登録{%endblock%}

<!-- css -->
{% block style %}
<link href="{% static 'css/sub.css' %}" rel="stylesheet">
{% endblock %}

<!-- breadcrumb -->
{% block breadcrumb %}
<li class="breadcrumb-item"><a href="/">ホーム</a></li>
<li class="breadcrumb-item active" aria-current="page">生徒情報</li>
<li class="breadcrumb-item active" aria-current="page">生徒登録</li>
{% endblock %}

<!-- sub-content -->
{% block content %}
<div class="register_form">
    <form>
        <div class="form-group">
            <label for="file">ファイル選択</label>
            <div id="file" class="input-group">
                <div class="custom-file">
                    <input type="file" id="cutomfile" class="custom-file-input" name="cutomfile[]" lang="ja" />
                    <label class="custom-file-label" for="customfile">ファイル選択...</label>
                </div>
                <div class="input-group-append">
                    <button type="button" class="btn btn-outline-secondary reset">取消</button>
                </div>
            </div>
        </div>
        <div class="form-group">
            <label for="studentName">氏名</label>
            <input type="input" class="form-control" id="studentName" placeholder="佐藤　太郎">
        </div>
        <div class="form-group">
            <label for="parentEmail">メールアドレス</label>
            <input type="email" class="form-control" id="parentEmail" placeholder="name@example.com">
        </div>
        <div class="form-group">
            <label for="scoolYears">学年</label>
            <select class="form-control" id="scoolYears">
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
                <option>6</option>
            </select>
        </div>
        <div class="form-group">
            <label for="remarks">備考</label>
            <textarea class="form-control" id="remarks" rows="3"></textarea>
        </div>
    </form>
</div>

<script>
    $('.custom-file-input').on('change', handleFileSelect);

    function handleFileSelect(evt) {
        $('#preview').remove(); // 繰り返し実行時の処理
        $(this).parents('.input-group').after('<div id="preview"></div>');
        var files = evt.target.files;

        for (var i = 0, f; f = files[i]; i++) {

            var reader = new FileReader();

            reader.onload = (function (theFile) {
                return function (e) {
                    if (theFile.type.match('image.*')) {
                        var $html = [
                            '<div class="d-inline-block mr-1 mt-1"><img class="img-thumbnail" src="', e
                            .target.result, '" title="', escape(theFile.name),
                            '" style="height:100px;" /><div class="small text-muted text-center">',
                            escape(theFile.name), '</div></div>'
                        ].join(''); // 画像では画像のプレビューとファイル名の表示
                    } else {
                        var $html = ['<div class="d-inline-block mr-1"><span class="small">', escape(theFile
                            .name), '</span></div>'].join(''); //画像以外はファイル名のみの表示
                    }

                    $('#preview').append($html);
                };
            })(f);

            reader.readAsDataURL(f);
        }

        $(this).next('.custom-file-label').html(+files.length + '個のファイルを選択しました');
    }

    //ファイルの取消
    $('.reset').click(function () {
        $(this).parent().prev().children('.custom-file-label').html('ファイル選択...');
        $('.custom-file-input').val('');
        $('#preview').remove('');
    })
</script>
{% endblock %}